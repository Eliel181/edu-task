<div class="my-10">
  <sx-calendar [calendarApp]="calendarApp"></sx-calendar>
</div>

<!-- Modal Unificado (Crear/Editar) -->
<div class="modal-overlay" *ngIf="isModalVisible" (click)="closeModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <form [formGroup]="visitaForm" (ngSubmit)="saveOrUpdateTask()">
      <h3>{{ isEditMode ? 'Editar Visita' : 'Agregar Nueva Visita' }}</h3>

      <div class="form-row">
        <div class="form-group">
          <label for="fecha">Fecha</label>
          <input id="fecha" formControlName="fecha" type="text">
        </div>
        <div class="form-group">
          <label for="horaInicio">Inicio</label>
          <input id="horaInicio" formControlName="horaInicio" type="time">
        </div>
        <div class="form-group">
          <label for="horaFin">Fin</label>
          <input id="horaFin" type="time" formControlName="horaFin">
        </div>
      </div>

      <div class="form-row">
        <div class="form-group form-group-large">
          <label for="add-task-calendar">Escuela *</label>
          <select id="add-task-calendar" formControlName="escuelaId" (change)="cargarEscuelaSeleccionada($event)">
            <option value="" disabled selected>Seleccione una escuela</option>
            @for (esc of escuelas(); track esc.id) {
            <option [value]="esc.id">{{esc.nombreCompleto}} - {{esc.cue}}</option>
            }
          </select>
        </div>
        <div class="form-group">
          <label for="cueEscuela">CUE</label>
          <input id="cueEscuela" name="cueEscuela" type="text" formControlName="cueEscuela">
        </div>
      </div>

      <div class="form-group">
        <label for="nombreEscuela">Nombre de la Escuela</label>
        <input id="nombreEscuela" name="nombreEscuela" type="text" formControlName="nombreEscuela">
      </div>

      <div class="form-group">
        <label for="direccionEscuela">Direcci√≥n</label>
        <input id="direccionEscuela" name="direccionEscuela" type="text" formControlName="direccionEscuela">
      </div>

      <div class="form-group">
        <label for="estado">Estado *</label>
        <select id="estado" name="estado" formControlName="estado">
          <option value="Planificada">Planificada</option>
          <option value="En Curso">En Curso</option>
          <option value="Finalizada">Finalizada</option>
        </select>
      </div>

      <div class="form-group">
        <label for="observaciones">Observaciones</label>
        <textarea id="observaciones" name="observaciones" formControlName="observaciones" rows="3"></textarea>
      </div>

      <div class="form-actions">
        <button type="button" class="btn-cancel" (click)="closeModal()">Cancelar</button>
        <button type="submit" class="btn-save" [disabled]="visitaForm.invalid">
          {{ isEditMode ? 'Guardar Cambios' : 'Guardar Visita' }}
        </button>
      </div>
    </form>
  </div>
</div>
